(window["webpackJsonpfilament-chatbot"]=window["webpackJsonpfilament-chatbot"]||[]).push([[0],{13:function(e,t,a){e.exports={container:"Bot_container__2VGZV",row:"Bot_row__1WNvO",column:"Bot_column__3FxMv",dialog_header:"Bot_dialog_header__3gQC4",bot_info_container:"Bot_bot_info_container__1QoM7",bot_image:"Bot_bot_image__3HCzV",bot_info:"Bot_bot_info__1M0OP",bot_name:"Bot_bot_name__yplY2",bot_status:"Bot_bot_status__yKAkH",bot_settings_container:"Bot_bot_settings_container__2rKUp",dialog_container:"Bot_dialog_container__1FXsU",dialog_content:"Bot_dialog_content__2yaNw",dark:"Bot_dark__1hUVt",light:"Bot_light__15Kdr",dialog_footer:"Bot_dialog_footer__Vcveq"}},14:function(e,t,a){e.exports={container:"TextMessage_container__25m6A",content_container:"TextMessage_content_container__RbvjM",icon:"TextMessage_icon__3xLtP",image:"TextMessage_image__1jWhP",default:"TextMessage_default__3sjTX",arrow:"TextMessage_arrow__1Jsqn",message:"TextMessage_message__2I9QM",body:"TextMessage_body__1kgkt",replying:"TextMessage_replying__GdoUI",blink:"TextMessage_blink__17LK2","sk-bouncedelay":"TextMessage_sk-bouncedelay__3rV7H",bounce1:"TextMessage_bounce1__1jSzL",bounce2:"TextMessage_bounce2__3AUgZ",left:"TextMessage_left__2EW1v",dark:"TextMessage_dark__3Jaj9",light:"TextMessage_light__oyrNI",right:"TextMessage_right__GpCv0"}},193:function(e,t,a){e.exports=a.p+"static/media/user.2b7412eb.svg"},196:function(e,t,a){e.exports=a(421)},26:function(e,t,a){e.exports={container:"CardMessage_container__1D5U1",content_container:"CardMessage_content_container__GfQLm",message:"CardMessage_message__1rH2k",body:"CardMessage_body__1MY4O",header:"CardMessage_header__32CIe",title:"CardMessage_title__StwvT",content:"CardMessage_content__uU3hS",image:"CardMessage_image__psyds",info_container:"CardMessage_info_container__39j_S",text:"CardMessage_text__3vnRT",link:"CardMessage_link__2dFo5",left:"CardMessage_left__23SFo"}},403:function(e,t,a){},408:function(e,t,a){},41:function(e,t,a){e.exports={container:"UserInput_container__NgtXv",content:"UserInput_content__3DZaI",pencil:"UserInput_pencil__3wC9M",input:"UserInput_input__KsO7i",send:"UserInput_send__3Tigg",dark:"UserInput_dark__cHTBV",light:"UserInput_light__2z3Lo"}},421:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"default",function(){return V});var r={};a.r(r),a.d(r,"default",function(){return J});var o={};a.r(o),a.d(o,"default",function(){return q});a(197),a(206);var s=a(0),i=a.n(s),c=a(192),l=a.n(c),m=(a(402),a(403),a(96)),d=a(97),u=a(100),g=a(98),_=a(101),f=a(78),v=a.n(f),p=a(79),h=a.n(p),b=a(128),E=a.n(b),y=a(99),k=a.n(y),T=a(193),N=a.n(T);var x=a(423),M=a(424),I=a(425),S=a(194),w=a(130);function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}var O=i.a.createContext({dark:!1,toggleTheme:function(){}}),j=function(){return i.a.useContext(O)},D=function(e){var t=e.children,a=function(){var e=i.a.useState({dark:!1,hasThemeMounted:!1}),t=Object(w.a)(e,2),a=t[0],n=t[1];return i.a.useEffect(function(){n({dark:"true"===localStorage.getItem("dark"),hasThemeMounted:!0})},[]),[a,n]}(),n=Object(w.a)(a,2),r=n[0],o=n[1];if(!r.hasThemeMounted)return i.a.createElement("div",null);return i.a.createElement(O.Provider,{value:{dark:r.dark,toggleTheme:function(){var e=!r.dark;localStorage.setItem("dark",JSON.stringify(e)),o(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(a,!0).forEach(function(t){Object(S.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},r,{dark:e}))}}},t)};function B(e){return{__html:e}}var U=a(56),F=a.n(U),P=function(e){var t=e.value,a=e.orientation,n=j().dark;return s.createElement("div",{className:"".concat(F.a.timestamp_container," ").concat("right"===a?F.a.right:F.a.left)},s.createElement("div",{className:"".concat(F.a.timestamp," ").concat(n?F.a.dark:F.a.light)},t||v()().format("LT")))},R=a(14),L=a.n(R),V=function(e){var t=e.message,a=t.value,n=t.timeStamp,r=t.image,o=t.orientation,i=t.isReplying,c=j().dark,l=i?s.createElement("div",{className:L.a.body},s.createElement("div",{className:L.a.replying},s.createElement("div",{className:L.a.bounce1}),s.createElement("div",{className:L.a.bounce2}),s.createElement("div",{className:L.a.bounce3}))):s.createElement("div",{className:L.a.body,dangerouslySetInnerHTML:B(a.message.text)});return s.createElement("div",{className:"".concat(L.a.container," ").concat("right"===o?L.a.right:L.a.left," ").concat(c?L.a.dark:L.a.light)},s.createElement("div",{className:L.a.content_container},s.createElement("div",{className:L.a.icon},s.createElement("div",{className:L.a.image,style:{backgroundImage:"url('".concat(r,"')")}})),"left"===o&&s.createElement("div",{className:L.a.arrow}),s.createElement("div",{className:L.a.message},l),"right"===o&&s.createElement("div",{className:L.a.arrow})),s.createElement(P,{value:n,orientation:o}))},K=a(26),H=a.n(K),J=function(e){var t=e.message,a=t.value,n=t.timeStamp,r=a.message,o=r.text,i=r.title,c=r.postback,l=r.url,m=s.createElement("div",{className:H.a.body},s.createElement("div",{className:H.a.header},s.createElement("div",{className:H.a.title},i)),s.createElement("div",{className:H.a.content},s.createElement("div",{className:H.a.image},s.createElement("div",null,s.createElement("img",{src:l,alt:""}))),s.createElement("div",{className:H.a.info_container},s.createElement("div",{className:H.a.text,dangerouslySetInnerHTML:B(o)}),s.createElement("div",{className:H.a.link},s.createElement("a",{href:c,target:"_blank",rel:"noopener noreferrer"},"More...")))));return s.createElement("div",{className:"".concat(H.a.container," ").concat(H.a.left)},s.createElement("div",{className:H.a.content_container},s.createElement("div",{className:H.a.message},m)),s.createElement(P,{value:n}))},W=a(48),Q=a.n(W),q=function(e){var t=e.message,a=t.value,n=t.timeStamp,r=a.message.uri,o=s.createElement("div",{className:Q.a.body},s.createElement("div",{className:Q.a.content},s.createElement("div",{className:Q.a.image},s.createElement("div",null,s.createElement("img",{src:r,alt:""})))));return s.createElement("div",{className:"".concat(Q.a.container," ").concat(Q.a.left)},s.createElement("div",{className:Q.a.content_container},s.createElement("div",{className:Q.a.message},o)),s.createElement(P,{value:n}))},z={text:n,card:r,image:o},A=function(e){var t=e.message.type,a=t?z[t].default:null;return a?s.createElement(a,e):null},G=(a(408),function(e){var t=e.label,a=e.checked,n=e.onToggle;return s.createElement("div",{className:"custom-control custom-switch"},s.createElement("input",{id:"custom-switch",type:"checkbox",className:"custom-control-input",checked:a,onChange:n}),s.createElement("label",{className:"custom-control-label",htmlFor:"custom-switch"},t))}),Z=a(129),X=a(195),$=a.n(X),Y=a(41),ee=a.n(Y),te=function(e){var t=e.userInputValue,a=e.placeholder,n=e.enableMicrophone,r=e.onTextFieldChanged,o=e.onSendClick,i=e.onKeyPress,c=j().dark;return s.createElement("div",{className:"".concat(ee.a.container," ").concat(c?ee.a.dark:ee.a.light),onKeyPress:i},s.createElement("div",{className:ee.a.content},s.createElement("div",{className:ee.a.pencil},s.createElement(Z.b,{icon:Z.a})),s.createElement("div",{className:ee.a.input},s.createElement($.a.Control,{size:"lg",type:"text",value:t,placeholder:a,onChange:r})),s.createElement("div",{className:ee.a.send,onClick:o},"Send"),n&&s.createElement("div",{className:"".concat(ee.a.microphone)},s.createElement("i",{className:"fa fa-microphone","aria-hidden":"true"}))))},ae=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(u.a)(this,Object(g.a)(t).call(this,e))).onTextFieldChanged=function(e){a.setState({userInputValue:e.currentTarget.value})},a.onSendClick=function(){a.sendUserInput(a.state.userInputValue)},a.onKeyPress=function(e){"Enter"===e.key&&(e.preventDefault(),a.sendUserInput(a.state.userInputValue))},a.sendUserInput=function(e){a.setState({userInputValue:""},function(){var t=a.props.onSendClick;t&&e&&t(e)})},a.state={userInputValue:""},a}return Object(_.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return s.createElement(te,Object.assign({},this.state,{placeholder:this.props.placeholder,onTextFieldChanged:this.onTextFieldChanged,onSendClick:this.onSendClick,onKeyPress:this.onKeyPress}))}}]),t}(s.Component),ne=a(13),re=a.n(ne),oe=function(e){var t=e.dialogData,a=e.onSendClick,n=e.messagesEndRef,r=t.dialogFlow,o=j(),i=o.dark;return s.createElement(x.a,{className:re.a.container},s.createElement(M.a,{className:re.a.row},s.createElement(I.a,{className:re.a.column},s.createElement(M.a,{className:re.a.dialog_header},s.createElement(I.a,{className:re.a.bot_info_container,xs:12,md:6},s.createElement("div",{className:re.a.bot_image},s.createElement("img",{className:re.a.image,src:k.a,alt:""})),s.createElement("div",{className:re.a.bot_info},s.createElement("div",{className:re.a.bot_name},"Filament Bot"),s.createElement("div",{className:re.a.bot_status},"online"))),s.createElement(I.a,{className:re.a.bot_settings_container,xs:12,md:6},s.createElement("div",{className:re.a.bot_settings},s.createElement(G,{label:i?"Dark mode":"Light mode",checked:i,onToggle:function(){return o.toggleTheme()}})))),s.createElement("div",{className:re.a.dialog_container},s.createElement("div",{className:"".concat(re.a.dialog_content," ").concat(i?re.a.dark:re.a.light),ref:n},r&&r.map(function(e,t){return s.createElement("div",{id:e.id,key:t},s.createElement(A,{message:e}))})),s.createElement("div",{className:"".concat(re.a.dialog_footer," ").concat(i?re.a.dark:re.a.light)},s.createElement(ae,{placeholder:"Ask a question...",onSendClick:a}))))))},se=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(u.a)(this,Object(g.a)(t).call(this,e))).onSendClick=function(e){var t=a.state,n=t.dialogData,r=t.botSettings,o=t.userSettings;a.updateDialogFlow(n.dialogFlow.concat([a.getUserData({message:{text:e}},o)]),n,0,{scrollDelay:0},function(){a.updateDialogFlow(a.state.dialogData.dialogFlow.concat([a.getBotData({message:{text:""}},"text",!0,!0)]),n,500,{scrollDelay:0},function(){a.getBotResponse(e,r,function(e){var t=a.getMessages(a.state.dialogData.dialogFlow,e),r=a.getLastUserMessage(t);a.updateDialogFlow(t,n,1e3,{scrollDelay:100,messageId:r&&r.id})})})})},a.getMessages=function(e,t){var n=e;if(t&&t.length){var r=!0,o=!0,s=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var m=c.value||{data:{text:""},type:"text"},d=m.data,u=m.type;if(d){var g=!0,_=!1,f=void 0;try{for(var v,p=d[Symbol.iterator]();!(g=(v=p.next()).done);g=!0){var h=v.value,b=a.getBotData({message:h},u,r);n=E()(n,{$splice:r?[[n.length-1,1,b]]:[[n.length,0,b]]})}}catch(y){_=!0,f=y}finally{try{g||null==p.return||p.return()}finally{if(_)throw f}}r=!1}}}catch(y){s=!0,i=y}finally{try{o||null==l.return||l.return()}finally{if(s)throw i}}}return n},a.getBotData=function(e,t,a,n){return{type:t,value:e,firstInSet:a,isReplying:n,source:"bot",image:k.a,orientation:"left",timeStamp:v()().format("LT"),id:h()()}},a.getUserData=function(e,t){return{value:e,type:"text",source:"user",image:(t||{userImage:""}).userImage,orientation:"right",timeStamp:v()().format("LT"),firstInSet:!1,id:h()()}},a.getBotResponse=function(e,t,n){if(t){var r=t.botUrl,o=t.botId,s=t.botProviderId,i=t.sessionId;(c=r,l={message:e,botId:o,providerId:s,sessionId:i},new Promise(function(e,t){fetch(c,{method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8"},body:JSON.stringify(l)}).then(function(e){return e.json()}).then(function(t){e(function(e){if(e){var t=e.status;if(t){var a=e.bot_response;if("misunderstood"===t)return[{type:"text",data:[{text:(a&&a.length?a[0]:{speech:""}).speech}]}];if("understood"===t){var n=a&&a.length?a:[];if(n&&n.length)return n.map(function(e){switch(e.type){case 0:return{type:"text",data:e.speech.map(function(e){return{text:e}})};case 5:return{type:"image",data:e.images};case 6:return{type:"card",data:e.cards};default:return{type:"text",data:[{text:"I'm sorry, I didn't understand that. Can you rephrase it?"}]}}})}}}return[{type:"error"}]}(t))}).catch(t)})).then(function(e){a.setState({botResponse:e},function(){n&&e&&n(e)})})}var c,l},a.updateDialogFlow=function(e,t,n,r,o){a.loadingTimeout=setTimeout(function(){a.setState({dialogData:E()(t,{dialogFlow:{$set:e}})},function(){if(clearTimeout(a.loadingTimeout),r){var t=r.messageId,n=r.scrollDelay;a.scrollToMessage(t||e[e.length-1].id,n)}o&&o()})},n)},a.initSettings=function(e,t){var n=e.botUrl,r=e.botId,o=e.botProviderId,s=e.welcomeMessage;a.setState({userSettings:{userId:h()(),userImage:N.a},botSettings:{botUrl:n,botId:r,botProviderId:o,welcomeMessage:s,sessionId:h()()}},function(){t&&t()})},a.scrollToMessage=function(e,t){a.messagesEndRef&&(a.scrollingTimeout=setTimeout(function(){var t=document.getElementById(e);t&&t.firstChild&&a.messagesEndRef.current.scrollTo(0,t.firstChild.offsetTop-140),clearTimeout(a.scrollingTimeout)},t||500))},a.getLastUserMessage=function(e){var t=e.filter(function(e){return"user"===e.source});return t.length?t[t.length-1]:void 0},a.state={botSettings:void 0,userSettings:void 0,dialogData:{dialogFlow:[]},scrollTop:0,isLoading:!0},a.loadingTimeout=null,a.scrollingTimeout=null,a.messagesEndRef=s.createRef(),a}return Object(_.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.settings;this.initSettings(t,function(){var t=e.state,a=t.botSettings,n=t.dialogData,r=a?a.welcomeMessage:"";e.updateDialogFlow([e.getBotData({message:{text:r}},"text")],n,0,void 0,function(){e.setState({isLoading:!1})})})}},{key:"render",value:function(){return s.createElement(oe,Object.assign({},this.state,{onSendClick:this.onSendClick,messagesEndRef:this.messagesEndRef}))}}]),t}(s.Component),ie="https://golin.ebm.filament.ai/api/chat/query",ce="6",le="4",me="Hi, mate. Ask me about Filament CEOs, delivery process and products.";var de=function(){var e={botUrl:ie,botId:ce,botProviderId:le,welcomeMessage:me};return i.a.createElement(D,null,i.a.createElement(se,{settings:e}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(i.a.createElement(de,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},48:function(e,t,a){e.exports={container:"ImageMessage_container__2CZ3J",content_container:"ImageMessage_content_container__3Jj46",message:"ImageMessage_message__12xsW",body:"ImageMessage_body__t9Ced",content:"ImageMessage_content__3QnRq",image:"ImageMessage_image__Wn6ND",left:"ImageMessage_left__xD-Qu"}},56:function(e,t,a){e.exports={timestamp_container:"TimeStamp_timestamp_container__-k-Fu",timestamp:"TimeStamp_timestamp__3w_TG",dark:"TimeStamp_dark__1lgfu",light:"TimeStamp_light__2vlma",left:"TimeStamp_left__cV12R",right:"TimeStamp_right__zS025"}},99:function(e,t,a){e.exports=a.p+"static/media/bot.48df58b9.svg"}},[[196,1,2]]]);
//# sourceMappingURL=main.54f3e865.chunk.js.map